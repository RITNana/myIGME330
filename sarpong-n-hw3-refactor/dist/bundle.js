(()=>{"use strict";var e,t,n,a,o,c,i,r,l=function(e,t,n,a){return void 0===a&&(a=1),"rgba(".concat(e,",").concat(t,",").concat(n,",").concat(a,")")},s=function(e,t){return Math.random()*(t-e)+e};!function(e){e[e.gain=.5]="gain",e[e.numSamples=256]="numSamples"}(e||(e={}));var u,h,d,v,f,g=function(e){n.src=e},m=function(){function e(e,t,n,a,o,c){this.x=e,this.y=t,this.width=n,this.height=a,this.color=o,this.angle+=.5,this.velocityX=3,this.velocityY=4,this.scaleFactor=1,this.scaleDirection=1,this.playButton=c}return e.prototype.update=function(e,t,n){if("yes"==this.playButton.dataset.playing){this.x+=this.velocityX*(e[0]/255)*this.getRandomDirection(),this.y+=this.velocityY*(e[0]/255)*this.getRandomDirection();var a=.01*this.scaleDirection;this.scaleFactor+=a*Math.exp(5*a),(this.scaleFactor>=1.5||this.scaleFactor<=.5)&&(this.scaleDirection*=-1)}this.x>t?this.x=0:this.x<0&&(this.x=t),this.y>n?this.y=0:this.y<0&&(this.x=n)},e.prototype.draw=function(e){e.save(),e.fillStyle=this.color,e.scale(this.scaleFactor,this.scaleFactor),e.fillRect(this.x,this.y,this.width,this.height),e.restore()},e.prototype.getRandomDirection=function(){return Math.random()<.2?-1:1},e}(),y=[],p=function(e){if(y.forEach((function(e){e.update(f,h,d),e.draw(u)})),e.toggleWave?v.getByteTimeDomainData(f):v.getByteFrequencyData(f),u.save(),u.fillStyle="black",u.globalAlpha=.1,u.fillRect(0,0,h,d),u.restore(),e.showBars){var t=(h-4*f.length-10)/f.length;u.save(),u.fillStyle="rgba(255, 255, 255, 0.50",u.strokeStyle="rgba(0,0,0,0.50)";for(var n=0;n<f.length;n++)u.fillRect(5+n*(t+4),356-f[n],t,200),u.strokeRect(5+n*(t+4),356-f[n],t,200);u.restore()}if(e.showCircles){var a=d/6;for(u.save(),u.globalAlpha=.5,n=0;n<f.length;n++){var o=f[n]/125,c=o*a;u.beginPath(),u.fillStyle=l(255,s(0,255),s(0,255),.34-o/12),u.arc(h/2,d/2,c,0,2*Math.PI,!1),u.fill(),u.closePath(),u.beginPath(),u.fillStyle=l(s(0,255),255,s(0,255),.05-o/3),u.arc(h/2,d/2,1.5*c,0,2*Math.PI,!1),u.fill(),u.closePath(),u.save(),u.beginPath(),u.fillStyle=l(s(0,255),s(0,255),255,.5-o/5),u.arc(h/2,d/2,.5*c,0,2*Math.PI,!1),u.fill(),u.closePath(),u.restore()}u.restore()}var i=u.getImageData(0,0,h,d),r=i.data,g=r.length,m=i.width;for(n=0;n<g;n+=4)e.noiseLevel>0&&Math.random()<e.noiseLevel&&(r[n]=r[n+1]=r[n+2]=0,r[n]=255);for(n=0;n<g;n+=4)if(e.invertLevel>0&&Math.random()<e.invertLevel){var p=r[n],S=r[n+1],q=r[n+2];r[n]=255-p,r[n+1]=255-S,r[n+2]=255-q}for(n=0;n<g;n++)if(e.embossLevel>0&&Math.random()<e.embossLevel){if(n%4==3)continue;r[n]=127+2*r[n]-r[n+4]-r[n+4*m]}u.putImageData(i,0,0)},S=document.querySelector("#cb-bars"),q=document.querySelector("#cb-circles"),b=document.querySelector("#cb-highshelf"),w=document.querySelector("#cb-lowshelf"),F=document.querySelector("#slider-noise"),T=document.querySelector("#slider-invert"),L=document.querySelector("#slider-emboss"),k=document.querySelector("#btnplay"),M=document.querySelector("#change-data"),x=b.checked,A=w.checked,R={showBars:!0,showCircles:!1,toggleWave:!1,noiseLevel:0,invertLevel:0,embossLevel:0},D=Object.freeze({sound1:"media/New Adventure Theme.mp3"}),E=function(e){var a;(a=new XMLHttpRequest).onload=function(e){var t;try{t=JSON.parse(a.responseText)}catch(e){return void console.log("BAD JSON!")}var n=t,o="";o+="<h2>".concat(n.title,"</h2>"),o+="<ol>".concat(n.audioFiles.map((function(e){return"<li>".concat(e,"</li>")})).join(""),"</ol>"),o+="<p>".concat(n.instructions,"</p>"),document.querySelector("#output").innerHTML=o},a.onerror=function(e){return console.log("In onerror - HTTP Status Code = ".concat(a.status))},a.open("GET","./data/av-data.json"),a.send();var o=document.querySelector("#btn-fs");k.onclick=function(e){var a=e.target;console.log("audioCtx.state before = ".concat(t.state)),"suspended"==t.state&&t.resume(),console.log("audioCtx.state after = ".concat(t.state)),"no"==a.dataset.playing?(n.play(),a.dataset.playing="yes"):(n.pause(),a.dataset.playing="no")},o.onclick=function(t){var n;console.log("goFullscreen() called"),(n=e).requestFullscreen?n.requestFullscreen():n.mozRequestFullscreen?n.mozRequestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen&&n.webkitRequestFullscreen()};var l=document.querySelector("#slider-volume"),s=document.querySelector("#label-volume");l.oninput=function(e){var t,n=e.target;t=n.value,t=Number(t),c.gain.value=t,s.innerHTML="".concat(Math.round(parseFloat(n.value)/2*100))},l.dispatchEvent(new Event("input")),document.querySelector("#select-track").onchange=function(e){var t=e.target;g(t.value),"yes"==k.dataset.playing&&k.dispatchEvent(new MouseEvent("click"))},F.addEventListener("input",(function(){R.noiseLevel=parseFloat(F.value),p(R)})),T.addEventListener("input",(function(){R.invertLevel=parseFloat(T.value),p(R)})),L.addEventListener("input",(function(){R.embossLevel=parseFloat(L.value),p(R)})),S.addEventListener("change",(function(){R.showBars=S.checked,p(R)})),q.addEventListener("change",(function(){R.showCircles=q.checked,p(R)})),b.onchange=function(e){var n=e.target;(x=n.checked)?(i.frequency.setValueAtTime(1e3,t.currentTime),i.gain.setValueAtTime(20,t.currentTime)):i.gain.setValueAtTime(0,t.currentTime)},w.onchange=function(e){var n=e.target;(A=n.checked)?(r.frequency.setValueAtTime(1e3,t.currentTime),r.gain.setValueAtTime(10,t.currentTime)):r.gain.setValueAtTime(0,t.currentTime)},M.onchange=function(e){"frequency"==e.target.value?R.toggleWave=!1:R.toggleWave=!0}},B=function(){setTimeout((function(){p(R),B()}),1e3/60)};window.onload=function(){!function(){var l,p;S.checked=!0,q.checked=!0,b.checked=x,w.checked=A,l=D.sound1,p=window.AudioContext,t=new p,n=new Audio,g(l),a=t.createMediaElementSource(n),(i=t.createBiquadFilter()).type="highshelf",(r=t.createBiquadFilter()).type="lowshelf",(o=t.createAnalyser()).fftSize=e.numSamples,(c=t.createGain()).gain.value=e.gain,a.connect(i),i.connect(r),r.connect(o),o.connect(c),c.connect(t.destination);var F=document.querySelector("canvas");E(F),function(e,t,n){u=e.getContext("2d"),h=e.width,d=e.height,v=t,f=new Uint8Array(v.fftSize/2);for(var a=0;a<100;a++){var o=new m(s(0,700),s(0,300),s(10,30),s(10,30),"rgba(".concat((c=function(){return s(35,220)})(),",").concat(c(),",").concat(c(),",1)"),n);y.push(o)}var c}(F,o,k),B()}()}})();
//# sourceMappingURL=bundle.js.map