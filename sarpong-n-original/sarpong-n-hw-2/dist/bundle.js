(()=>{"use strict";var e,t,n,o,a,r,i,c=function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return"rgba(".concat(e,",").concat(t,",").concat(n,",").concat(o,")")},l=function(e,t){return Math.random()*(t-e)+e},s=Object.freeze({gain:.5,numSamples:256}),u=(new Uint8Array(s.numSamples/2),function(e){t.src=e});function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function f(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,v(o.key),o)}}function v(e){var t=function(e,t){if("object"!=h(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!=h(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==h(t)?t:t+""}var d,y,g,m,p,b,w=function(){return e=function e(t,n,o,a,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t,this.y=n,this.width=o,this.height=a,this.color=r,this.angle+=.5,this.velocityX=3,this.velocityY=4,this.scaleFactor=1,this.scaleDirection=1,this.playButton=i},t=[{key:"update",value:function(e,t,n){if("yes"==this.playButton.dataset.playing){this.x+=this.velocityX*(e[0]/255)*this.getRandomDirection(),this.y+=this.velocityY*(e[0]/255)*this.getRandomDirection();var o=.01*this.scaleDirection;this.scaleFactor+=o*Math.exp(5*o),(this.scaleFactor>=1.5||this.scaleFactor<=.5)&&(this.scaleDirection*=-1)}this.x>t?this.x=0:this.x<0&&(this.x=t),this.y>n?this.y=0:this.y<0&&(this.x=n)}},{key:"draw",value:function(e){e.save(),e.fillStyle=this.color,e.scale(this.scaleFactor,this.scaleFactor),e.fillRect(this.x,this.y,this.width,this.height),e.restore()}},{key:"getRandomDirection",value:function(){return Math.random()<.2?-1:1}}],t&&f(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}(),S=[],q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(S.forEach((function(e){e.update(p,y,g),e.draw(d)})),e.toggleWave?m.getByteTimeDomainData(p):m.getByteFrequencyData(p),d.save(),d.fillStyle="black",d.globalAlpha=.1,d.fillRect(0,0,y,g),d.restore(),e.showBars){var t=(y-4*p.length-10)/p.length;d.save(),d.fillStyle="rgba(255, 255, 255, 0.50",d.strokeStyle="rgba(0,0,0,0.50)";for(var n=0;n<p.length;n++)d.fillRect(5+n*(t+4),356-p[n],t,200),d.strokeRect(5+n*(t+4),356-p[n],t,200);d.restore()}if(e.showCircles){var o=g/6;d.save(),d.globalAlpha=.5;for(var a=0;a<p.length;a++){var r=p[a]/125,i=r*o;d.beginPath(),d.fillStyle=c(255,l(0,255),l(0,255),.34-r/12),d.arc(y/2,g/2,i,0,2*Math.PI,!1),d.fill(),d.closePath(),d.beginPath(),d.fillStyle=c(l(0,255),255,l(0,255),.05-r/3),d.arc(y/2,g/2,1.5*i,0,2*Math.PI,!1),d.fill(),d.closePath(),d.save(),d.beginPath(),d.fillStyle=c(l(0,255),l(0,255),255,.5-r/5),d.arc(y/2,g/2,.5*i,0,2*Math.PI,!1),d.fill(),d.closePath(),d.restore()}d.restore()}for(var s=d.getImageData(0,0,y,g),u=s.data,h=u.length,f=s.width,v=0;v<h;v+=4)e.noiseLevel>0&&Math.random()<e.noiseLevel&&(u[v]=u[v+1]=u[v+2]=0,u[v]=255);for(var b=0;b<h;b+=4)if(e.invertLevel>0&&Math.random()<e.invertLevel){var w=u[b],q=u[b+1],T=u[b+2];u[b]=255-w,u[b+1]=255-q,u[b+2]=255-T}for(var k=0;k<h;k++)if(e.embossLevel>0&&Math.random()<e.embossLevel){if(k%4==3)continue;u[k]=127+2*u[k]-u[k+4]-u[k+4*f]}d.putImageData(s,0,0)},T={showBars:!0,showCircles:!0,toggleWave:!1,noiseLevel:0,invertLevel:0,embossLevel:0},k=!1,F=!1,L=document.querySelector("#cb-bars"),A=document.querySelector("#cb-circles"),x=document.querySelector("#cb-highshelf"),M=document.querySelector("#cb-lowshelf"),E=document.querySelector("#slider-noise"),P=document.querySelector("#slider-invert"),R=document.querySelector("#slider-emboss"),D=Object.freeze({sound1:"media/New Adventure Theme.mp3"}),B=function(n){var o;(o=new XMLHttpRequest).onload=function(e){var t;try{t=JSON.parse(e.target.responseText)}catch(e){return void console.log("BAD JSON!")}var n=t,o="";o+="<h2>".concat(n.title,"</h2>"),o+="<ol>".concat(n.audioFiles.map((function(e){return"<li>".concat(e,"</li>")})).join(""),"</ol>"),o+="<p>".concat(n.instructions,"</p>"),document.querySelector("#output").innerHTML=o},o.onerror=function(e){return console.log("In onerror - HTTP Status Code = ".concat(e.target.status))},o.open("GET","./data/av-data.json"),o.send();var c=document.querySelector("#btn-fs");btnplay.onclick=function(n){console.log("audioCtx.state before = ".concat(e.state)),"suspended"==e.state&&e.resume(),console.log("audioCtx.state after = ".concat(e.state)),"no"==n.target.dataset.playing?(t.play(),n.target.dataset.playing="yes"):(t.pause(),n.target.dataset.playing="no")},c.onclick=function(e){var t;console.log("goFullscreen() called"),(t=n).requestFullscreen?t.requestFullscreen():t.mozRequestFullscreen?t.mozRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()};var l=document.querySelector("#slider-volume"),s=document.querySelector("#label-volume");l.oninput=function(e){var t;t=e.target.value,t=Number(t),a.gain.value=t,s.innerHTML=Math.round(e.target.value/2*100)},l.dispatchEvent(new Event("input")),document.querySelector("#select-track").onchange=function(e){u(e.target.value),"yes"==btnplay.dataset.playing&&btnplay.dispatchEvent(new MouseEvent("click"))},E.addEventListener("input",(function(){T.noiseLevel=parseFloat(E.value),q(T)})),P.addEventListener("input",(function(){T.invertLevel=parseFloat(P.value),q(T)})),R.addEventListener("input",(function(){T.embossLevel=parseFloat(R.value),q(T)})),L.addEventListener("change",(function(){L.checked?q(T.showBars=!0):q(T.showBars=!1)})),A.addEventListener("change",(function(){A.checked?q(T.showCircles=!0):q(T.showCircles=!1)})),x.onchange=function(t){(k=t.target.checked)?(r.frequency.setValueAtTime(1e3,e.currentTime),r.gain.setValueAtTime(20,e.currentTime)):r.gain.setValueAtTime(0,e.currentTime)},M.onchange=function(t){(F=t.target.checked)?(i.frequency.setValueAtTime(1e3,e.currentTime),i.gain.setValueAtTime(10,e.currentTime)):i.gain.setValueAtTime(0,e.currentTime)},document.querySelector("#change-data").onchange=function(e){"frequency"==e.target.value?T.toggleWave=!1:T.toggleWave=!0}},C=function e(){setTimeout((function(){q(T),e()}),1e3/60)};window.onload=function(){!function(){var c,h;L.checked=!0,A.checked=!0,x.checked=k,M.checked=F,c=D.sound1,h=window.AudioContext||window.webkitAudioContext,e=new h,t=new Audio,u(c),n=e.createMediaElementSource(t),(r=e.createBiquadFilter()).type="highshelf",(i=e.createBiquadFilter()).type="lowshelf",(o=e.createAnalyser()).fftSize=s.numSamples,(a=e.createGain()).gain.value=s.gain,n.connect(r),r.connect(i),i.connect(o),o.connect(a),a.connect(e.destination);var f=document.querySelector("canvas");B(f),function(e,t,n){d=e.getContext("2d"),y=e.width,g=e.height,m=t,p=new Uint8Array(m.fftSize/2);for(var o=0;o<100;o++)b=new w(l(0,700),l(0,300),l(10,30),l(10,30),"rgba(".concat((a=function(){return l(35,220)})(),",").concat(a(),",").concat(a(),",1)"),n),S.push(b);var a}(f,o,btnplay),C()}()}})();